<div class="container text-center">
    <div class="container">
        <h1>Tasks backlog</h1>

        <a [routerLink]="['/tasks', {outlets: {'sidebar': 'task-out'}}]">Start sidebar</a>

        <hr />

        <h3>
            {{ queuedPomodoros | i18nPlural: queueHeaderMapping }} for today

            <span class="small" *ngIf="queuedPomodoros > 0">
                (Estimated time: {{ queuedPomodoros * timerMinutes | pomodoroFormattedTime }})
            </span>
        </h3>

        <p>
            <span *ngFor="let queuedTask of tasks | pomodoroQueuedOnly: true">
                <pomodoro-task-icons
                    [task]="queuedTask"
                    size="50"
                    [taskTooltip]="tooltip"
                >
                </pomodoro-task-icons>
            </span>
        </p>
        <p #tooltip [hidden]="queuedPomodoros === 0">Mouseover for details</p>

        <table class="table">
            <thead>
                <tr>
                    <th>Task ID</th>
                    <th>Task name</th>
                    <th>Deliver by</th>
                    <th>Pomodoros</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                <tr *ngFor="let item of tasks; let i = index"  class="ng-animate">
                    <th scope="row">
                        {{ i + 1 }}
                        <span *ngIf="item.queued" class="label label-info ng-animate">Queued</span>
                    </th>
                    <td>
                        {{ item.name | slice: 0:35 }}
                        <span [hidden]="item.name.length < 35" >...</span>
                    </td>
                    <td>
                        {{ item.deadline | date: 'shortDate'}}
                        <span *ngIf="item.deadline < today" class="label label-danger">Due</span>
                    </td>
                    <td class="text-center">{{ item.pomodorosRequired }}</td>
                    <td>
                        <button type="button" class="btn btn-default btn-xs"
                            (click)="toggleTask(item)"
                            [ngSwitch]="item.queued"
                        >
                            <ng-template [ngSwitchCase]="false">
                                <i class="glyphicon glyphicon-plus-sign"></i> Add
                            </ng-template>
                            <ng-template [ngSwitchCase]="true">
                                <i class="glyphicon glyphicon-minus-sign"></i> Remove
                            </ng-template>
                            <ng-template ngSwitchDefault>
                                <i class="glyphicon glyphicon-plus-sign"></i> Add
                            </ng-template>
                        </button>

                        <button type="button" class="btn btn-default btn-xs" *ngIf="item.queued" (click)="workOn(i)">
                            <i class="glyphicon glyphicon-expand"></i> Start
                        </button>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
</div>
